<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>جرد المخزون</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#1976d2">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="جرد المخزون">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <style>
    :root{
      --bg:#f4f5f7;
      --card:#fff;
      --primary:#1976d2;
      --green:#1b5e20;
      --text:#222;
      --muted:#777;
      --border:#e0e0e0
    }

    body{
      font-family:system-ui,-apple-system,BlinkMacSystemFont;
      background:var(--bg);
      margin:0;
      padding:8px
    }

    /* ================= LOGIN ================= */
    .login-wrap{
      max-width:380px;
      margin:80px auto;
      text-align:center
    }

    .login-card{
      background:var(--card);
      border-radius:16px;
      padding:18px;
      box-shadow:0 8px 20px rgba(0,0,0,.12)
    }

    .login-title{
      font-size:18px;
      font-weight:600;
      margin-bottom:14px;
      color:var(--primary)
    }

    .login-input{
      width:100%;
      padding:10px;
      font-size:14px;
      border-radius:10px;
      border:1px solid var(--border);
      margin-bottom:10px
    }

    .login-msg{
      margin-top:10px;
      font-size:13px;
      color:#c62828
    }

    /* ================= APP ================= */
    .top-bar{
      max-width:430px;
      margin:0 auto 6px;
      display:flex;
      justify-content:space-between;
      align-items:center
    }

    .top-title{
      font-size:15px;
      font-weight:600;
      color:var(--text)
    }

    .top-actions{
      display:flex;
      gap:6px
    }

    .icon-btn{
      width:30px;
      height:30px;
      border:none;
      border-radius:8px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:16px;
      background:var(--card);
      box-shadow:0 1px 4px rgba(0,0,0,.12);
      color:var(--text);
      cursor:pointer
    }

    .filter-wrap{max-width:430px;margin:0 auto 8px}
    .filter-card{background:var(--card);border-radius:12px;padding:6px;box-shadow:0 2px 6px rgba(0,0,0,.05)}
    .filter-row{display:flex;gap:4px;margin-bottom:4px}
    .filter-input{flex:1;padding:6px 7px;font-size:12px;border-radius:8px;border:1px solid var(--border);background:#fafafa}

    #results{max-width:430px;margin:0 auto 8px}
    .msg{text-align:center;padding:10px;color:var(--muted);font-size:13px}

    .detail-save{
      margin-top:10px;
      width:100%;
      padding:10px;
      border:none;
      border-radius:10px;
      background:var(--primary);
      color:#fff;
      font-size:15px;
      cursor:pointer
    }
  </style>
</head>

<body>

<!-- ================= LOGIN SCREEN ================= -->
<div id="loginScreen" class="login-wrap" style="display:none">
  <div class="login-card">
    <div class="login-title">تسجيل الدخول</div>
    <input id="loginName" class="login-input" placeholder="اسم المستخدم">
    <button class="detail-save" onclick="login()">دخول</button>
    <div id="loginMsg" class="login-msg"></div>
  </div>
</div>

<!-- ================= APP ================= -->
<div id="appScreen" style="display:none">

  <div class="top-bar">
    <div class="top-title">جرد المخزون</div>
    <div class="top-actions">
      <button class="icon-btn" onclick="logout()">⎋</button>
    </div>
  </div>

  <div class="filter-wrap">
    <div class="filter-card">
      <div class="filter-row">
        <input class="filter-input" id="pContains" placeholder="رقم الصنف يحتوي على">
      </div>
    </div>
  </div>

  <div id="results"></div>

</div>

<script>
/* ===== LOGIN LOGIC ===== */
function login(){
  const name = loginName.value.trim();
  if(!name){
    loginMsg.textContent = "أدخل اسم المستخدم";
    return;
  }
  localStorage.setItem("inv_user_name", name);
  initApp();
}

function logout(){
  localStorage.removeItem("inv_user_name");
  location.reload();
}

function initApp(){
  loginScreen.style.display="none";
  appScreen.style.display="block";
  loadData();
}

(function(){
  const u = localStorage.getItem("inv_user_name");
  if(u){
    initApp();
  }else{
    loginScreen.style.display="block";
  }
})();
</script>

</body>
</html>
